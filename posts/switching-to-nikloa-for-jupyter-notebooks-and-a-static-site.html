<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Switching to Nikloa for Jupyter Notebooks and a static site | Biophysics and Beer</title>
<link href="../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="https://mglerner.github.io/posts/switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Michael G. Lerner">
<link rel="prev" href="can-i-be-smarter-about-late-policies.html" title="Can I be smarter about late policies?" type="text/html">
<link rel="next" href="visualizing-differential-geometry-in-jupyter-notebooks.html" title="Visualizing differential geometry in Jupyter notebooks" type="text/html">
<meta property="og:site_name" content="Biophysics and Beer">
<meta property="og:title" content="Switching to Nikloa for Jupyter Notebooks and a static site">
<meta property="og:url" content="https://mglerner.github.io/posts/switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html">
<meta property="og:description" content="I've been using WordPress for quite a while, almost entirely because
it's an out-of-the-box blog setup that just works. But it kind of
sucks for what I mostly want to do, which is stick some code into">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-10-12T13:52:49Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@website">
<meta name="twitter:creator" content="@username">
<link rel="stylesheet" href="../assets/font-awesome/css/font-awesome.min.css">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">

        <nav role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../"><i class="fa fa-2x fa-fw fa-home"></i> Home</a>
          <!--a class="sidebar-nav-item" href="/blog"><i class="fa fa-2x fa-fw fa-user-circle" /> Blog</a-->
          <a class="sidebar-nav-item" href="../pages/about.html"><i class="fa fa-2x fa-fw fa-user-circle"></i> About
        </a></nav><nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../archive.html">Archives</a>
        <a class="sidebar-nav-item" href="../categories/index.html">Tags</a>
        <a class="sidebar-nav-item" href="../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h2 id="brand" class="masthead-title">
      <a href="https://mglerner.github.io/" title="Biophysics and Beer" rel="home">Biophysics and Beer</a>
    </h2>
    <img src="../mglblogheader.png">
</div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/BlogPosting"><header><h1 class="post-title p-name entry-title" itemprop="headline">
      <a href="https://mglerner.github.io/posts/switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html" class="u-url">Switching to Nikloa for Jupyter Notebooks and a static site</a>
</h1>
        <div class="metadata">
        <meta itemprop="inLanguage" content="en">
<p class="dateline">
            <time class="post-date published dt-published" datetime="2017-10-12T13:52:49+00:00" itemprop="datePublished" title="2017-10-12 13:52">2017-10-12 13:52</time></p>
                <p class="commentline">
        
    <a href="switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html#disqus_thread" data-disqus-identifier="cache/posts/switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html">Comments</a>


        </p>
</div>
        

    </header><section class="e-content entry-content" itemprop="articleBody text"><div>
<p>I've been using WordPress for quite a while, almost entirely because
it's an out-of-the-box blog setup that just works. But it kind of
sucks for what I mostly want to do, which is stick some code into blog
posts. In fact, what usually happens is that I do something in a
Jupyter notebook, and want to stick it up as a blog post. That's a
real pain in WordPress. The best I found was converting the notebooks
to html and then including them as a static block, but those
invariably are brittle and ugly.</p>
<p>So, smart people like <a href="http://jakevdp.github.io">Jake Vanderplas</a> and
<a href="http://themodernscientist.com">themodernscientist</a> switched over to
something that deals natively with Jupyter notebooks a long time ago
(so long ago they were called IPython Notebooks!). I'm a slow pony,
but I'm switching to Nikola. It seems to be the easiest one at the
moment. It's a static page generator, which is more than fine for my
purposes, and it deals natively with Jupyter notebooks. Sweet. I
thought it would be useful to document the process for future-me. I
leaned heavily on the Nikola site (including the
<a href="https://getnikola.com/handbook.html#importing-your-wordpress-site-into-nikola">documentation for import_wordpress</a>). The
process wasn't completely trivial, but that's because I did some hacky
stuff to get Jupyter Notebooks included in my WordPress posts
anyway. This seems like a lot of work for like 13 posts, but nobody
ever claimed I was wise.</p>
<p><strong>[UPDATE: I ended up switching all of my old IPython/Jupyter posts over to notebooks rather than HTML. If you read an earlier version of this, basically everything else is the same]</strong></p>
<!-- TEASER_END -->

<h3>Grabbing the site</h3>
<p>Log in as an administrator, go to the Tools menu, click on Export,
then download an Export File. Nice and easy. Thanks, WordPress!</p>
<h3>Install Nikola</h3>
<p><em>Note:</em> <code>pip</code> doesn't actually play nicely with the conda
 environments. It looks like it installs nikola's stuff on top of
 everything else (e.g. the Nikola tools are available even when I'm
 not in the <code>blog</code> environment from below). That's not great. I
 probably should use a virtualenv, but I don't have time to learn what
 one of those is today.</p>
<p>I'm using Anaconda for my Python, and Nikola installs via pip, so I
make a new environment just for the blog. Probably good practice
anyway. Speaking of which, this is all Python 3. There's some
<a href="https://github.com/ContinuumIO/anaconda-issues/issues/542">weird bug</a>
involved in having pip upgrade setuptools,</p>
<pre class="code literal-block"><span></span>conda create --name blog
<span class="nb">source</span> activate blog
conda install setuptools
pip install --upgrade <span class="s2">"Nikola[extras]"</span>
mkdir blog
<span class="nb">cd</span> blog
mkdir posts
mkdir output
</pre>


<p>Now import the wordpress site. If I just say</p>
<pre class="code literal-block"><span></span>nikola import_wordpress ~/Downloads/biophysicsandbeer.wordpress.2017-10-10.xml
</pre>


<p>I don't actually get some of my content imported. In particular, the
quoted Python code doesn't show up. So,</p>
<pre class="code literal-block"><span></span>nikola import_wordpress --download-auth<span class="o">=[</span>my secret username<span class="o">]</span>:<span class="o">[</span>my secret password<span class="o">]</span> --install-wordpress-compiler --transform-to-html ~/Downloads/biophysicsandbeer.wordpress.2017-10-10.xml
</pre>


<p>Tells it to be explicit about converting to html and downloading
everything it can. It also produces some errors, specifically a bunch
of lines like</p>
<pre class="code literal-block"><span></span>[<span class="mi">2017</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">11</span><span class="nv">T19</span>:<span class="mi">49</span>:<span class="mi">10</span><span class="nv">Z</span>] <span class="nv">WARNING</span>: <span class="nv">Nikola</span>: <span class="nv">Can</span><span class="s1">'</span><span class="s">t do a redirect for: </span><span class="s1">'</span><span class="nv">http</span>:<span class="o">//</span><span class="nv">www</span>.<span class="nv">mglerner</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">blog</span><span class="o">/</span>?<span class="nv">p</span><span class="o">=</span><span class="mi">8</span><span class="o">/</span><span class="s1">'</span>
</pre>


<p>which are telling us that it can't just spit out a new file in place
of the old one because the question marks in the URL mean request
data. We'll deal with this in a minute.</p>
<p>We then fire up the site with</p>
<pre class="code literal-block"><span></span><span class="nb">cd</span> new_site
nikola build
nikola serve --browser
</pre>


<p>And it almost all works. Here are the missing things:</p>
<h3>Comments are all missing.</h3>
<ol>
<li>For future stuff to work, I'll get a Disqus ID and start using
   it. (biophysics-and-beer ... check).</li>
<li>Add all of the old comments by hand. This isn't taking a huge
   amount of time, because I don't have a huge amount of comments, and
   I'm not going crazy with matching formatting. I'm just copying the
   comments div from the old blog. If you're doing this to your own
   blog, don't forget to get rid of the "response" part of the
   comments div. If I had it to do over, I'd write a script that did
   that for me, or I'd learn how to import comments into Disqus, but
   it didn't take much time this way. On the plus side, I'm ditching
   some (not all) spam I had missed.</li>
</ol>
<h3>Cleaning up long posts</h3>
<p>Some of the posts are really long. Like, to the point where the main
page is something ridiculous like 80MB. I <em>think</em> WordPress deals with
this automatically (only showing the first few paragraphs in the
index), because I didn't remember it being an issue. You can tell
Nikola to only show a "teaser" by putting</p>
<pre class="code literal-block"><span></span><span class="n">INDEX_TEASERS</span> <span class="o">=</span> <span class="bp">True</span>
</pre>


<p>in <code>conf.py</code></p>
<p>And then adding</p>
<pre class="code literal-block"><span></span><span class="o">&lt;!</span><span class="c1">-- TEASER_END --&gt;</span>
</pre>


<p>to a Markdown cell in a Jupyter notebook, or directly to a Markdown
post, or directly to an html post. Cool.</p>
<h3>My pre-rendered Jupyter notebooks suck.</h3>
<p>I used the pageview WordPress plugin (short code? I don't know) to
include pre-rendered Jupyter notebooks. That just breaks upon
import. But the Nikloa posts are just straight HTML. I can just
include the stuff directly.</p>
<p>That was pretty easy, and it worked, but it seemed lame and "Teasers"
didn't work when I stuck them in the middle of the pre-rendered HTML
blocks. So, I switched everything over to Jupyter notebooks.</p>
<p>When I do that, I need to</p>
<ul>
<li>make sure I include comments explicitly in the Jupyter notebook. As
mentioned above, I can just include the raw html for them. To do this
in a Markdown cell in a Jupyter notebook, do something like</li>
</ul>
<pre class="code literal-block"><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">'''fancy pants html code for comments here'''</span><span class="p">)</span>
</pre>


<ul>
<li>
<p>I also need to remember to edit the meta data at the end of the
imported Jupyter notebook so that Nikola gets the date right. You have
to remember to do that <em>after</em> Nikola imports the post.</p>
</li>
<li>
<p>I also need to remember to stick a Markdown cell near the top with a
  link to download the whole things as a Jupyter notebook
  directly. This part is pretty awesome: I can link directly to the
  Jupyter notebook on the Nikola site, rather than stuffing a copy in
  a gist, etc. Neat!</p>
</li>
</ul>
<h3>Getting a graphical header/theme fun time</h3>
<p>I found the
<a href="https://getnikola.com/creating-a-theme.html">Nikola tutorial for theming</a>
... somewhat more than I was interested in. But, it had enough useful
nuggets to figure out the basics. The basic idea is (1) put my header
image somewhere (2) edit the header template. Let's go.</p>
<p>First, I'm going to want to change the <code>base_header.tmpl</code> so I
searched for themes that came with that on the
<a href="https://github.com/getnikola/nikola-themes/find/master">Nikola Theme site</a>. Of
those, I like <code>jidn</code> the most. So,</p>
<pre class="code literal-block"><span></span>nikola theme -i bootstrap3-gradients
</pre>


<p>Then edit <code>conf.py</code> to switch the theme to jidn and, as indicated in
the text when you install the jidn theme, add a few lines to <code>conf.py</code></p>
<pre class="code literal-block"><span></span><span class="n">THEME</span> <span class="o">=</span> <span class="ss">"jidn"</span>
<span class="p">...</span>
<span class="n">GLOBAL_CONTEXT</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span>
    <span class="ss">"JIDN"</span><span class="p">:</span> <span class="err">{}</span><span class="p">,</span>  <span class="o">#</span> <span class="n">Extra</span> <span class="n">info</span> <span class="n">about</span> <span class="n">authors</span>
    <span class="o">#</span> <span class="ss">"JIDN-theme"</span><span class="p">:</span> <span class="ss">"theme-base-blue"</span><span class="p">,</span>
<span class="err">}</span><span class="p">)</span>
<span class="p">...</span>
</pre>


<p>(Actually, as described in the jidn README.md, you can add more info
to that dictionary, so I added a link to my twitter profile image,
etc. Neat.)</p>
<p>The WordPress import stuck all of the versions of my header in
<code>files/blog/wp-content/wp-content/uploads/</code> and I'm just copying them
to <code>files</code> to make them easy to find. Then I add the <code>img</code> tag right
after the title in <code>themes/jidn/templates/base_header.tmpl</code>:</p>
<pre class="code literal-block"><span></span>    <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"brand"</span> <span class="na">class=</span><span class="s">"masthead-title"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">${</span><span class="n">abs_link</span><span class="p">(</span><span class="n">_link</span><span class="p">(</span><span class="s2">"root"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="p">))</span><span class="cp">}</span><span class="s">"</span> <span class="na">title=</span><span class="s">"</span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="s">"</span> <span class="na">rel=</span><span class="s">"home"</span><span class="nt">&gt;</span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/mglblogheader.png"</span> <span class="nt">/&gt;</span>
</pre>


<p>I'm very far from up-to-date with modern web
design, but that looks OK for now.</p>
<p>While I'm editing the templates,
there's a link to "blog" in the sidebar I don't want, so I replaced it
with a link to the about page.</p>
<h3>Missing buttons</h3>
<p>The code in <code>post.tmpl</code> looks like it should work, but the icons don't
show up. This means I'm missing the links to my twitter/github
profile, the "share this on your favorite social media site" links,
and the buttons that link to next/previous post.</p>
<p>It looks to me like it's trying to grab stuff from
<a href="http://fontawesome.io/get-started/">FontAwesome</a>, but I don't see
anywhere that the FontAwesome stuff is actually linked on my
site. Following the FontAwesome directions,</p>
<ul>
<li>Download the <code>font-awesome</code> directory.</li>
<li>Stick it in <code>themes/jidn/assets/font-awesome</code>
</li>
<li>Add the following to <code>base.tmpl</code>:</li>
</ul>
<pre class="code literal-block"><span></span><span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="ss">"stylesheet"</span> <span class="n">href</span><span class="o">=</span><span class="ss">"path/to/font-awesome/css/font-awesome.min.css"</span><span class="o">&gt;</span>
</pre>


<p>... Now, I added it right before <code>&lt;/head&gt;</code>, which looks ot me like
it's OK, but it's right after a place where it says "don't change this
block" so it's possible that I screwed something up.</p>
<p>That fixes the lack of next/previous/social buttons.</p>
<h3>Back to the redirects</h3>
<p>Those redirects are kind of a pain. That's Nikola saying it can't just
spit out a new file in place of the old file because the question
marks mean request data. Thanks, wordpress! I wanted simple stuff like
an <code>.htaccess</code> file saying</p>
<pre class="code literal-block"><span></span><span class="n">Redirect</span> <span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="n">page8</span> <span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="k">new</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="n">fancy</span><span class="p">.</span><span class="n">html</span>
</pre>


<p>but no ... Now I need to look at a
<a href="https://stackoverflow.com/questions/9182585/apache-redirect-permanent-for-url-with-data-in-string-question-mark">StackOverflow answer</a>
and remember why I stopped being a web developer years ago. Here's my
new <code>.htaccess</code> file</p>
<pre class="code literal-block"><span></span><span class="n">RewriteEngine</span><span class="w"> </span><span class="k">on</span><span class="w"></span>
<span class="n">RewriteBase</span><span class="w"> </span><span class="o">/</span><span class="w"></span>

<span class="n">RewriteCond</span><span class="w"> </span><span class="o">%</span><span class="err">{</span><span class="n">THE_REQUEST</span><span class="err">}</span><span class="w"> </span><span class="o">^[</span><span class="n">A-Z</span><span class="o">]</span><span class="err">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="err">}\</span><span class="w"> </span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="err">\</span><span class="vm">?</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="w"> </span><span class="o">[</span><span class="n">NC</span><span class="o">]</span><span class="w"></span>
<span class="n">RewriteRule</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="n">posts</span><span class="o">/</span><span class="n">the</span><span class="o">-</span><span class="n">blogging</span><span class="o">-</span><span class="n">begins</span><span class="p">.</span><span class="n">html</span><span class="w"> </span><span class="o">[</span><span class="n">L,R=301</span><span class="o">]</span><span class="w"></span>
<span class="n">RewriteCond</span><span class="w"> </span><span class="o">%</span><span class="err">{</span><span class="n">THE_REQUEST</span><span class="err">}</span><span class="w"> </span><span class="o">^[</span><span class="n">A-Z</span><span class="o">]</span><span class="err">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="err">}\</span><span class="w"> </span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="err">\</span><span class="vm">?</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="o">[</span><span class="n">NC</span><span class="o">]</span><span class="w"></span>
<span class="n">RewriteRule</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="n">posts</span><span class="o">/</span><span class="n">the</span><span class="o">-</span><span class="n">blogging</span><span class="o">-</span><span class="n">begins</span><span class="p">.</span><span class="n">html</span><span class="w"> </span><span class="o">[</span><span class="n">L,R=301</span><span class="o">]</span><span class="w"></span>
</pre>


<p>to handle people accessing each page both with and without a trailing
slash. Now, where should I point the redirects?</p>
<h3>Static site means why host it myself?</h3>
<p>It made sense to host my own WordPress site. But I'm not sure I need
to host my own static site. In fact, life would probably be easier if
I just used github pages. Cool.  Github has
<a href="https://pages.github.com">instructions</a> that basically boil down to
"set up a repo called mglerner.github.io and do some special things"
... and Nikola means I don't have to actually know what those special
things are! After initializing my Nikola blog directory as a github
repo and doing</p>
<pre class="code literal-block"><span></span>git remote add origin git@github.com:mglerner/mglerner.github.io.git
</pre>


<p>I can make Nikola rebuild things like github wants, add, commit and
push everything automatically with</p>
<pre class="code literal-block"><span></span>nikola github_deploy
</pre>


<p>So, after having done that, I just make the <code>.htaccess</code> file listed
above point everything from my old site to my fancy new github site.</p>
<p>... and it's up and running!</p>
<h3>Making it possible to post with Jupyter notebooks</h3>
<p>This is documented in a few places, but sometimes things change, so
you're probably better off just looking at the Nikola site
directly. At the moment, you need to add the last line here to each of
<code>POSTS</code> and <code>PAGES</code> in <code>/blog/conf.py</code>, so that Nikola will recognize
Jupyter notebooks as ... you know ... both posts and pages. You also
need to add the trailing line in <code>COMPILERS</code>.</p>
<pre class="code literal-block"><span></span><span class="n">POSTS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s2">"posts/*.rst"</span><span class="p">,</span> <span class="s2">"posts"</span><span class="p">,</span> <span class="s2">"post.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"posts/*.txt"</span><span class="p">,</span> <span class="s2">"posts"</span><span class="p">,</span> <span class="s2">"post.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"posts/*.md"</span><span class="p">,</span> <span class="s2">"posts"</span><span class="p">,</span> <span class="s2">"post.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"posts/*.html"</span><span class="p">,</span> <span class="s2">"posts"</span><span class="p">,</span> <span class="s2">"post.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"posts/*.ipynb"</span><span class="p">,</span> <span class="s2">"posts"</span><span class="p">,</span> <span class="s2">"post.tmpl"</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">PAGES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s2">"pages/*.rst"</span><span class="p">,</span> <span class="s2">"pages"</span><span class="p">,</span> <span class="s2">"story.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"pages/*.txt"</span><span class="p">,</span> <span class="s2">"pages"</span><span class="p">,</span> <span class="s2">"story.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"pages/*.md"</span><span class="p">,</span> <span class="s2">"pages"</span><span class="p">,</span> <span class="s2">"story.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"pages/*.html"</span><span class="p">,</span> <span class="s2">"pages"</span><span class="p">,</span> <span class="s2">"story.tmpl"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"pages/*.ipynb"</span><span class="p">,</span> <span class="s2">"pages"</span><span class="p">,</span> <span class="s2">"story.tmpl"</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">COMPILERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"rest"</span><span class="p">:</span> <span class="p">(</span><span class="s1">'.txt'</span><span class="p">,</span> <span class="s1">'.rst'</span><span class="p">),</span>
    <span class="s2">"markdown"</span><span class="p">:</span> <span class="p">(</span><span class="s1">'.md'</span><span class="p">,</span> <span class="s1">'.mdown'</span><span class="p">,</span> <span class="s1">'.markdown'</span><span class="p">),</span>
    <span class="s2">"html"</span><span class="p">:</span> <span class="p">(</span><span class="s1">'.html'</span><span class="p">,</span> <span class="s1">'.htm'</span><span class="p">),</span>
    <span class="s2">"ipynb"</span><span class="p">:</span> <span class="p">(</span><span class="s1">'.ipynb'</span><span class="p">,),</span>
<span class="p">}</span>
</pre>


<h3>Making posts</h3>
<p>Now comes the whole point: making new posts. Blog posts come with meta
data (when it was created, etc.) that normally gets automatically
handled when you create a new post via <code>nikola new_post -e</code>. If you
want to start with other formats (e.g. Markdown or Jupyter notebooks),
you just stick the relevant file in <code>/posts</code> and import it via <code>nikola
new_post -i</code>.</p>
<p>I took the notes for this migration in Markdown, so I just stick that
file in <code>/posts/BlogMigration.md</code> run <code>nikola new_post -i
posts/BlogMigration</code> ...</p>
<p>Or, at least, that's how it should work. I'm a little disappointed to
find that the new post import keeps breaking, saying it can't find
metadata like the date. It's an easy workaround for markdown: I just
make a new post, then copy over my markdown. Looking at the results, I
find that Nikola wants the metadata imbedded in the markdown file. So,
I should have started the markdown file with</p>
<pre class="code literal-block"><span></span><span class="o">&lt;!--</span>
.. <span class="nv">title</span>: <span class="nv">Switching</span> <span class="nv">to</span> <span class="nv">Nikloa</span> <span class="k">for</span> <span class="nv">Jupyter</span> <span class="nv">Notebooks</span> <span class="nv">and</span> <span class="nv">a</span> <span class="nv">static</span> <span class="nv">site</span>
.. <span class="nv">slug</span>: <span class="nv">switching</span><span class="o">-</span><span class="nv">to</span><span class="o">-</span><span class="nv">nikloa</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="nv">jupyter</span><span class="o">-</span><span class="nv">notebooks</span><span class="o">-</span><span class="nv">and</span><span class="o">-</span><span class="nv">a</span><span class="o">-</span><span class="nv">static</span><span class="o">-</span><span class="nv">site</span>
.. <span class="nv">date</span>: <span class="mi">2017</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">12</span> <span class="mi">13</span>:<span class="mi">50</span>:<span class="mi">23</span> <span class="nv">UTC</span>
.. <span class="nv">tags</span>: 
.. <span class="nv">category</span>: 
.. <span class="nv">link</span>: 
.. <span class="nv">description</span>: 
.. <span class="nv">type</span>: <span class="nv">text</span>
<span class="o">--&gt;</span>
</pre>


<p>Cool. I tested, and I can indeed just stick that at the top of my
markdown file (which I'm storing in a folder called <code>drafts</code>) and then
import. Almost. Of all things, it sticks that metadata in twice. So,
for now, the clear answer is just to make a blank post and then copy
in my markdown. Easy enough.</p>
<p>Meanwhile, importing Jupyter notebooks seems to just work!</p>
<p>then <code>nikola build</code>, then fire up a test server to check it out with
<code>nikola serve --browser</code>, verify that all looks awesome, and push it
to the blog with <code>nikola github_deploy</code>!</p>
<h3>TODO</h3>
<ul>
<li>The text is too big. I can apparently change that in <code>jidn</code>'s
 <code>custom.css</code> but I don't quite get how.</li>
</ul>
<h3>Jupyter issues</h3>
<p>The conversion of Jupyter notebooks doesn't look perfect yet:</p>
<ul>
<li>
<p>Inline math (starting with a single dollar sign) doesn't always get
  converted. Starting with two dollar signs does seem to consistently
  work.</p>
</li>
<li>
<p>For JSAnimations, the "animation bar" doesn't have images on the
  buttons. <strong>UPDATE:</strong> That seems to have magically fixed itself. The
  FontAwesome thing may have been the key, but I'm going full
  cargo-cult mentality here and just saying it worked.</p>
</li>
</ul>
<h3>Updated Quick Notes</h3>
<p>To create a new environment</p>
<pre class="code literal-block"><span></span>conda create -n blog <span class="nv">python</span><span class="o">=</span><span class="m">3</span>
conda activate blog
</pre>


<p>Then double-check to make sure you're using the <code>pip</code> from the conda
environment. Then</p>
<pre class="code literal-block"><span></span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="c1">--upgrade "Nikola[extras]"</span>
</pre>


<p>Then</p>
<pre class="code literal-block"><span></span>nikola build
nikola new_post -i drafts/thing.md
nikola serve --browser
nikola github_deploy
</pre>
</div>
    </section><aside class="sharing no-print"><a href="#content" aria-label="Post beginning">
       <i class="fa fa-2x fa-fw fa-arrow-circle-up" aria-hidden="true" title="Post beginning"></i>
    </a>
    <a href="https://mglerner.github.io/posts/can-i-be-smarter-about-late-policies.html" rel="prev" title="Can I be smarter about late policies?">
       <i class="fa fa-2x fa-fw fa-arrow-circle-left" aria-hidden="true" title="Previous post: Can I be smarter about late policies?"></i>
    </a>
    <a href="https://mglerner.github.io/posts/visualizing-differential-geometry-in-jupyter-notebooks.html" rel="next" title="Next post: Visualizing differential geometry in Jupyter notebooks" aria-label="Next post: Visualizing differential geometry in Jupyter notebooks">
       <i class="fa fa-2x fa-fw fa-arrow-circle-right" aria-hidden="true"></i>
    </a>
    <span class="post-sharing">
     <a href="http://twitter.com/share?text=Switching+to+Nikloa+for+Jupyter+Notebooks+and+a+static+site&amp;url=https%3A%2F%2Fmglerner.github.io%2Fposts%2Fswitching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" aria-label="Share on Twitter">
       <i class="fa fa-2x fa-fw fa-twitter-square" aria-hidden="true" title="Share on Twitter">
     </i></a>
     <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmglerner.github.io%2Fposts%2Fswitching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" aria-label="Share on Facebook">
       <i class="fa fa-2x fa-fw fa-facebook-square" style="margin-left: -8px" aria-hidden="true" title="Share of Facebook">
     </i></a>
     <a href="https://plus.google.com/share?url=https%3A%2F%2Fmglerner.github.io%2Fposts%2Fswitching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html" aria-label="Share on Google+" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
       <i class="fa fa-2x fa-fw fa-google-plus-square" style="margin-left: -8px" aria-hidden="true" title="Share on Google+">
     </i></a>
     </span>
</aside><div itemprop="author" itemscope itemtype="http://schema.org/Person">
<footer class="byline author author-bio vcard"><hr>
<meta itemprop="image" content="https://pbs.twimg.com/profile_images/196327413/MGLProfile_400x400.jpg">
<div class="author-image" style="background: url(https://pbs.twimg.com/profile_images/196327413/MGLProfile_400x400.jpg)"></div>
     <h3 class="byline-name fn" itemprop="name">Michael G. Lerner
        <span class="post-sharing">
            <a href="mailto:mglerner@protonmail.com?subject=Switching%20to%20Nikloa%20for%20Jupyter%20Notebooks%20and%20a%20static%20site" aria-label="Email author">
            <i class="fa fa-2 fa-fw fa-envelope" aria-hidden="true" title="Email author">
            </i></a>
        </span>
        <span class="post-sharing">
            <a href="https://twitter.com/mglerner" target="_blank" arial-label="Go to Twitter"> <i class="fa fa-fw fa-twitter" aria-hidden="true" title="Twitter"></i></a>
            <a href="https://github.com/mglerner" target="_blank" arial-label="Go to GitHub"> <i class="fa fa-fw fa-github" aria-hidden="true" title="GitHub"></i></a>
        </span>
     </h3>
     <p class="bio">Biophysicist, pedagogy, lipids, membranes, sometimes even proteins and nucleic acids. <a href="https://github.com/mglerner/IntroductoryPhysics">Decolonising my Introductory Physics Syllabus</a>.</p>
</footer>
</div>


        <section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="biophysics-and-beer",
            disqus_url="https://mglerner.github.io/posts/switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html",
        disqus_title="Switching to Nikloa for Jupyter Notebooks and a static site",
        disqus_identifier="cache/posts/switching-to-nikloa-for-jupyter-notebooks-and-a-static-site.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="biophysics-and-beer";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2019         <a href="mailto:mglerner@protonmail.com">Michael G. Lerner</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
    
    
            <script src="../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
